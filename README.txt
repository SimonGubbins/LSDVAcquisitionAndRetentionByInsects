This folder contains the Matlab scripts and functions, as well the necessary data files, to implement the parameter estimation
methods in Sanz Bernardo et al. "Quantifying the acquisition and retention of lumpy skin disease virus by haematophagus insects
and the implications for transmission and control"

MATLAB REQUIREMENTS
The scripts/functions were run using Matlab version 2019b and require the Statistics and Machine Learning and
Parallel Computing toolboxes. However, they can be easily adapted to run without the Parallel Computing toolbox
by changing any "parfor" loops to "for" loops in the functions with names beginning "ParEst".

PROBABILITY OF TRANSMISSION FROM BOVINE TO INSECT

Simple model (Text S4.1)
------------------------
ParEst_B2I.m - loads the data, implements the adaptive Metropolis scheme for each model parameterisation
               and computes the DIC
Lhood_B2I.m - computes the log likelihood and prior for the input parameters for the model without a dose-response
	      relatioship

Dose-response model (Text S4.2)
-------------------------------
ParEstToo_B2I.m - loads the data, implements the adaptive Metropolis scheme for each model parameterisation
                  and computes the DIC
LhoodToo_B2I.m - computes the log likelihood and prior for the input parameters for the dose-response model relating viral
                 titre to the probability of transmission

Data (for all models)
---------------------
InsectData.txt - data on outcome of feeding insects on LSDV infected-calves; columns are (cf. Data S1):
                 1 - insect species (1-Aedes aegypti, 2-Culex quinquefasciatus, 3-Culicoides nubeculosus, 4-Stomoxys calcitrans)
                 2 - identifier of calf on which insect fed
                 3 - status of donor calf (1-clinical, 2-subclinical)
                 4 - days post infection of calf on which insect fed
                 5 - days post feeding at which insect was tested
                 6 - level of viral DNA in blood (log10 copies/ml) of calf at feeding
                 7 - level of viral DNA in skin (log10 copies/mg) of calf at feeding; note NaN means titre not measured
                 8 - negative (0) or positive (1) when tested for viral DNA


PROBABILITY OF TRANSMISSION FROM BOVINE TO INSECT (Text S4.3)
(Note: these functions require the MCMC samples generated by ParEst_B2I.m to generate prior distributions)

Models for Ae. aegypti, Cx. quinquefasciatus and C. nubeculosus
---------------------------------------------------------------
ParEst_I2B.m - loads the data and implements the adaptive Metropolis scheme for each species
Lhood_I2B.m - computes the log likelihood and prior for the input parameters

Model for S. calcitrans
-----------------------
ParEstToo_I2B.m - loads the data and implements the adaptive Metropolis scheme for S. calcitrans
LhoodToo_I2B.m - computes the log likelihood and prior for the input parameters

Data
----
ChihotaData_[spp].txt - data on transmission from insect to bovine for all four species extracted from Chihota et al. 2001
                        Epidemiol. Infect. 126, 317-321 (Ae. aegypti) and Chihota et al. 2003 Med. Vet. Entomol. 17, 294-300
                        (see also Table S1 in Gubbins 2019 Transboundary Emerg. Dis. 66, 1873-1883); columns are:
                        1 - days post feeding when insects refed on naive bovine
                        2 - no. insects refeeding
                        3 - outcome of challenge (0-no transmission, 1-transmission)

SciensanoData_[name].txt - data on transmission from insect to bovine for S. calcitrans extracted from Sohier et al. 2019
                           Scientific Reports 9, 20076
SciensanoData_RecipientList.txt - vector of IDs for recipient cattle
SciensanoData_TimeOfOnset.txt - vector of times of onset of viraemia (days post initial feed) for each recipient
SciensanoData_ChallengeData.txt - challenge data, columns are:
                                  1 - recipient ID
                                  2 - time batch first fed on recipient
                                  3 - time batch last fed on recipient
                                  4 - no. flies in batch
                                  5 - status of donor (0-subclinical, 1-clinical)


DURATION OF LATENT AND INFECTIOUS PERIODS (Text S5)

Clinical cattle
---------------
estimateDurEI_Clin.m - script containing data on latent and infectious periods in clinical cattle and which calls the
                       function (ParEst_DurEI_Clin.m) to estimate parameters
ParEst_DurEI_Clin.m - function which implements a random-walk Metropolis-Hastings scheme to estimate latent/infectious period
                      parameters in clinical cattle

estimatePrClinical.odc - OpenBUGS (version 3.2.3) script to estimate the proportion of cattle developing clinical disease

Subclinical cattle
------------------
estimateDurEI_SubClin.m - script containing data on latent and infectious periods in subclinical cattle and which calls the
                          function (ParEst_DurEI_SubClin.m) to estimate parameters
ParEst_DurEI_SubClin.m - function which implements a random-walk Metropolis-Hastings scheme to estimate latent/infectious period
                         parameters in subclinical cattle

